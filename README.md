dig-lsh-clustering
==================

Clustering documents based on LSH

Requirements
------------
1. gensim: sudo pip install -U gensim

Usage
-----

Usage: 
```
runLSH.py --input <input filename> --output <output filename> [--separator <sep=\t>] [--dataType integer|string] [--numHashes <numHashes=20>] [--numItemsInBand <numItemsInBand=5>] [--minItemsInCluster <minItemsInCluster=2>]
```

* Input file is a tab separated file with key followed by tokens. The tokens can be separated by any separator that can be specified in the runLSH arguments
* The Output file is a JSON file with the clusters.

```gen_clusters``` contains sample clusters for dig dataset
  *  ```clean_title``` contains clusters generated using the deobfuscated title
      *  ```clean_title_preprocess.py``` takes the input json returned by the ES query and returns the file in a format required by runLSH
      * ```istr-100k-clean-title.json``` is the json retuned by ES query
      * ```istr-100k-clean-title-for-lsh.tsv``` is the file generated by the ```clean_title_preprocess.py``` script for inputing to runLSH
      * ```istr-100k-clean-title-clusters.json``` are the clusters generated by runLSH using the following command:
        
        ```
         python runLSH.py --input gen_clusters/clean_title/istr-100k-clean-title-for-lsh.tsv --output gen_clusters/clean_title/istr-100k-clean-title-clusters.json --dataType string --numItemsInBand 10 --numHashes 20
        ```

  ```gen_int_input``` contains code to take in a tab separated file of Key\ttokens and convert the string tokens to integers and output the string\tinteger hashmap.
  *  ```clean_title``` contains clusters generated using the deobfuscated title
      *  ```clean_title_preprocess.py``` takes the input json returned by the ES query and returns the file in a format required by runLSH
      * ```istr-100k-clean-title.json``` is the json retuned by ES query
      * ```istr-100k-clean-title-for-lsh.tsv``` is the file generated by the ```clean_title_preprocess.py``` script for inputing to runLSH
      * ```istr-100k-clean-title-clusters.json``` are the clusters generated by runLSH using the following command:

        ```
         python gen_int_input/str_to_nt_tokens.py  gen_clusters/clean_title/istr-100k-clean-title-for-lsh.tsv  gen_clusters/clean_title/istr-100k-clean-title-for-lsh-int.tsv gen_clusters/clean_title/istr-100k-clean-title-for-lsh-hashmap.tsv
        ```

        To generate the clusters now with integer input, run:
        ```
         python runLSH.py --input gen_clusters/clean_title/istr-100k-clean-title-for-lsh-int.tsv --output gen_clusters/clean_title/istr-100k-clean-title-clusters-int.json --dataType integer --numItemsInBand 10 --numHashes 20
        ```
